syntax = "proto3";

package fmtrpc;

option go_package = "github.com/SSSOC-CAN/fmtd/fmtrpc";

service DataCollector {
    /* fmtcli: `start-record`
    StartRecording will begin recording data from Fluke software and writing it.
    */
    rpc StartRecording (RecordRequest) returns (RecordResponse);
    /* fmtcli: `stop-record`
    StopRecording will end the recording of data from Fluke software.
    */
    rpc StopRecording (StopRecRequest) returns (StopRecResponse);
    /* fmtcli: `subscribe-data-stream`
    SubscribeDataStream returns a uni-directional stream (server -> client) of data being recorded from the Fluke DAQ.
    */
    rpc SubscribeDataStream (SubscribeDataRequest) returns (stream RealTimeData);
}

message RecordRequest {
    int64 polling_interval = 1;
}

message RecordResponse {
    string msg = 1;
}

message StopRecRequest {
}

message StopRecResponse {
    string msg = 1;
}

message SubscribeDataRequest {
}

message DataField {
    string name = 1;
    double value = 2;
}

message RealTimeData {
    bool is_scanning = 1;
    string timestamp = 2;
    map<int64, DataField> data = 3;
}